
  <!--show the header-->
  <div class="container-fluid">
    <div class="row">
      <!-- <mat-card class="wrap">
        <mat-card-header>
          <capx-header [moduleTitle]="this.pageTitle"></capx-header>
        </mat-card-header>
      </mat-card> -->

      <div class="col-md-12" style="margin-top:3px;">
        <div class="content">
          <div class="container-fluid">
            <div class="row" style="width: 100%;">
              <p class="page-title">
                {{pageTitle}}
              </p>
            </div>
            <div class="row" style="width: 100%;">
              <div class="col-xl-12">
                <div style="display: table">
                  <!--Loading gif-->
                  <div *ngIf="!dropdownsLoaded || !formLoaded" style="display: table-row">
                    Please wait while your account information loads
                    <mat-progress-bar [ngStyle]="{'width.px' : innerWidth * 0.95 }" mode="indeterminate"></mat-progress-bar>
                  </div>
                  <div  *ngIf="dropdownsLoaded && formLoaded && farmId !== 0" style="display: table-row; margin-top: 50px;">
                    <app-grower-account-header [id]="farmId"></app-grower-account-header>
                  </div>
                </div>
              </div>
              <div class="col-xl-6 col-md-12">
                <div style="display: table">
                  <!--Main Form-->
                  <div  *ngIf="dropdownsLoaded && formLoaded" style="display: table-row; margin-top: 50px;">
                    <form [formGroup]="growerForm">
                      <div class="row" [hidden]="farmId > 0" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <div class="col-md-2">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline" style="width: 275px;">
                              <mat-label>Owner</mat-label>
                              <input type="text" name="Owner" matInput placeholder="Owner" formControlName="Owner" >
                            </mat-form-field>
                          </div>
                        </div>
                      </div>
                      <div class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <!-- todo - are these useful fields or not?-->
                        <div class="col-md-3">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline" style="width: 275px;">
                              <mat-label>Address 1</mat-label>
                              <input type="text" matInput placeholder="Address 1" formControlName="Address1" >
                            </mat-form-field>
                          </div>
                        </div>
                        <div class="col-md-2">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline" style="width: 275px;">
                              <mat-label>Address 2</mat-label>
                              <input type="text" name="Address2" matInput placeholder="Address 2" formControlName="Address2"  >
                            </mat-form-field>
                          </div>
                        </div>
                      </div>
                      <!-- todo - are these useful fields or not?-->
                      <!-- <div class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <div class="col-md-2">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline">
                              <mat-label>City</mat-label>
                              <input type="text" name="City" matInput placeholder="City" formControlName="City" >
                            </mat-form-field>
                          </div>
                        </div>
                      </div>
                      <div class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <div class="col-md-2">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline">
                              <mat-label>Zip</mat-label>
                              <input type="text" name="Zip" matInput placeholder="Zip" formControlName="Zip" >
                            </mat-form-field>
                          </div>
                        </div>
                      </div> -->
                      <div class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <div class="col-md-2">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline">
                              <mat-label>Phone</mat-label>
                              <input type="text" name="Phone" matInput placeholder="Phone" formControlName="Phone" >
                            </mat-form-field>
                          </div>
                        </div>
                        <div class="col-md-2">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline">
                              <mat-label>Cell Phone</mat-label>
                              <input type="text" name="CellPhone" matInput placeholder="Cell Phone" formControlName="CellPhone" >
                            </mat-form-field>
                          </div>
                        </div>
                      </div>
                      <div class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <div class="col-md-2">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline" style="width: 275px;">
                              <mat-label>Email</mat-label>
                              <input type="email" name="Email" matInput placeholder="Email" formControlName="Email"  >
                            </mat-form-field>
                          </div>
                        </div>
                      </div>
                      <div class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <div class="col-md-12">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field appearance="outline">
                              <mat-label>Vendor Id</mat-label>
                              <input type="text" name="VendorId" matInput placeholder="Vendor Id" formControlName="VendorId" (keyup)="onVendorChange($event)"  >
                            </mat-form-field>
                            {{vendorName}}
                          </div>
                        </div>
                      </div>
                      <div class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <div class="col-md-2">
                          <div style="display: table" [formGroup]="growerForm" >
                            <mat-form-field style="width: 300px;" appearance="outline">
                              <mat-label>Comments</mat-label>
                              <textarea matInput placeholder="Comments" rows="5" formControlName="Comments"></textarea>
                            </mat-form-field>
                          </div>
                        </div>
                      </div>
                      <div *ngIf="formLoaded && farmId.toString() !== '0'" class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        <div class="col-md-2">
                          <div style="display: table">
                            Status: {{growerModel.status}}
                          </div>
                        </div>
                      </div>
                      <div class="row" [ngStyle]="{'width.px' : innerWidth * 0.95 }">
                        &nbsp;
                      </div>
                    </form>
                  </div>
                  <div *ngIf="dropdownsLoaded && formLoaded" style="display: table-row; margin-top: 30px;">
                    <button
                      mat-raised-button
                      type="button"
                      color="warn"
                      (click)="backToHome()"
                      [matTooltip]="'Return to the grower account list'"
                      [matTooltipPosition]="'above'"
                    >
                    <mat-icon>undo</mat-icon>
                      Back
                    </button>
                    <button
                      mat-raised-button
                      type="button"
                      *ngIf="farmId.toString() !== '0'"
                      style="margin-left: 15px;"
                      color="warn"
                      (click)="archiveGrowerModal = true"
                      [matTooltip]="'Archive this grower'"
                      [matTooltipPosition]="'above'"
                    >
                    <mat-icon>archive</mat-icon>
                      Archive
                    </button>

                    <button
                      mat-raised-button
                      type="button"
                      *ngIf="growerModel.status.trim() !== 'Active'"
                      style="margin-left: 15px;"
                      color="fdblue"
                      (click)="reactivateGrower()"
                      [matTooltip]="'Archive this grower'"
                      [matTooltipPosition]="'above'"
                    >
                    <mat-icon>lock_open</mat-icon>
                      Reactivate
                    </button>

                    <button
                      mat-raised-button
                      style="margin-left: 15px;"
                      type="button"
                      color="fdblue"
                      [disabled]="postSubmitted || (!growerForm.valid || !!!vendorName || vendorName === '' || vendorName === 'INVALID')"
                      (click)="submitGrower()"
                      appDisabledForRole="Grower Accounting Read Only"
                    >
                    <mat-spinner
                      *ngIf="postSubmitted"
                      [diameter]="35"
                      style="float:right;"
                    ></mat-spinner>
                    <mat-icon>save</mat-icon>
                      Submit
                    </button>
                  </div>

                </div>
              </div>
              <div class="col-xl-6 col-md-12" *ngIf="dropdownsLoaded && formLoaded && farmId !== 0"  >
                <div style="display: table">
                  <div style="display: table-row; margin-top: 50px;">
                    <span>Related Growers for Vendor</span>
                    <div *ngIf="relatedVendorLoaded">
                      <ag-grid-angular
                        #relatedVendorGrowerGrid
                        [ngStyle]="{'width.px': innerWidth * 0.48, 'height.px': 110 * relatedVendorGrowers.length }"
                        class="ag-theme-material"
                        [rowData]="relatedVendorGrowers"
                        [columnDefs]="relatedVendorGrowerColumnDefs"
                        (gridReady)="onRelatedVendorGrowerGridReady($event)"
                        [embedFullWidthRows]="true"
                        [animateRows]="true"
                        [suppressHorizontalScroll]="true"
                        [modules]="modules">
                      </ag-grid-angular>
                    </div>
                  </div>
                  <div style="display: table-row; margin-top: 50px;">
                    <span>Related Growers</span>
                    <div *ngIf="relatedLoaded">
                      <ag-grid-angular
                        #relatedGrowerGrid
                        [ngStyle]="{'width.px':  innerWidth * 0.48, 'height.px': 110 * relatedGrowers.length }"
                        class="ag-theme-material"
                        [rowData]="relatedGrowers"
                        [columnDefs]="relatedGrowerColumnDefs"
                        (gridReady)="onRelatedGrowerGridReady($event)"
                        [frameworkComponents]="frameworkComponents"
                        [embedFullWidthRows]="true"
                        [animateRows]="true"
                        [suppressHorizontalScroll]="true"
                        [modules]="modules">
                      </ag-grid-angular>
                    </div>
                  </div>
                  <div style="display: table-row;" *ngIf="newRelatedGrowerListLoaded">
                    <button
                      mat-raised-button
                      style="margin-left: 15px;"
                      type="button"
                      color="fdblue"
                      [matTooltip]="'Add a new related grower for ' + growerModel.farmName"
                      [matTooltipPosition]="'above'"
                      (click)="newRelatedGrowerModal = true"
                    >
                    <mat-icon>add</mat-icon>
                      Add Related Grower
                    </button>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>






  <div class="example-wrapper">
    <kendo-dialog
      *ngIf="newRelatedGrowerModal"
      (close)="newRelatedGrowerModal = false"
      [minWidth]="250"
      [width]="innerWidth * 0.8"
      [height]="550"
    >
      <kendo-dialog-titlebar
        style="background-color: RGB(0, 74, 138); color: white; font-size: 18px;"
      >
        <div
          style="font-size: 18px; line-height: 1.3em; color: white !important;"
        >
          <span class="k-icon k-i-notification"></span> Select Related Grower
        </div>
      </kendo-dialog-titlebar>
      <div style="margin-top: 30px;">
        <span *ngIf="!!selectedAddRelatedGrower">You have selected {{selectedAddRelatedGrower.id}} - {{selectedAddRelatedGrower.farmName}}</span>
        <ag-grid-angular
          #addRelatedGrower
          [ngStyle]="{'width.px': innerWidth * 0.75, 'height.px': 350 }"
          class="ag-theme-material"
          [rowData]="newRelatedGrowers"
          [columnDefs]="addNewRelatedGrowerColumns"
          (gridReady)="onAddNewRelatedGrowerColumns($event)"
          [embedFullWidthRows]="true"
          [rowSelection]="'single'"
          [animateRows]="true"
          [floatingFilter]="true"
          (selectionChanged)="onSelectionChanged()"
          [suppressHorizontalScroll]="true"
          [modules]="modules">
        </ag-grid-angular>
      </div>


      <kendo-dialog-actions>
        <button
        mat-raised-button
        color="warn"
        style="width: 50% !important;"
        (click)="newRelatedGrowerModal = false"
      >
        Cancel
      </button>
      <button
        mat-raised-button
        color="primary"
        [disabled]="!!!selectedAddRelatedGrower"
        style="width: 50% !important;"
        (click)="submitAddRelatedGrower()"
      >
        Yes, Add this Related Grower
      </button>
      </kendo-dialog-actions>
    </kendo-dialog>
  </div>


  <div class="example-wrapper">
    <kendo-dialog
      *ngIf="archiveGrowerModal"
      (close)="archiveGrowerModal = false"
      [minWidth]="250"
      [width]="400"
      [height]="200"
    >
      <kendo-dialog-titlebar
        style="background-color: RGB(0, 74, 138); color: white; font-size: 18px;"
      >
        <div
          style="font-size: 18px; line-height: 1.3em; color: white !important;"
        >
          <span class="k-icon k-i-notification"></span> Archive Grower?
        </div>
      </kendo-dialog-titlebar>
      <div style="margin-top: 30px; text-align: center;">

          Do you wish to archive this grower?


      </div>


      <kendo-dialog-actions>
        <button
        mat-raised-button
        color="warn"
        style="width: 50% !important;"
        (click)="archiveGrowerModal = false"
      >
        Cancel
      </button>
      <button
        mat-raised-button
        color="primary"
        style="width: 50% !important;"
        (click)="archiveGrower()"
      >
        Yes, Archive This Grower
      </button>
      </kendo-dialog-actions>
    </kendo-dialog>
  </div>
